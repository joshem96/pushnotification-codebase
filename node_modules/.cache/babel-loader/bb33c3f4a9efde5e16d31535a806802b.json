{"ast":null,"code":"import { globalInfo } from './global_Info.js';\nimport { insertPush } from './pushExample/functions';\n\n//takes a string and injects it into the API status after 2 seconds\nfunction APILogBuffer(log) {\n  debugger;\n  //after 10s, return the string (log)\n  setTimeout(() => {\n    console.log(globalInfo());\n    globalInfo().APIStatus.innerHTML = log;\n  }, 2000);\n}\n\n//fetch all submission data into an array from the API\n_c = APILogBuffer;\nfunction fetchSubmissionResponses() {\n  debugger;\n  console.log(globalInfo());\n  window.JF.getFormSubmissions(globalInfo().formID, function (response) {\n    console.log('recieved form submission data');\n    console.log('delete function responses ' + response);\n    //add all responses to globalInfo so accesible globally\n    globalInfo().submissionResponses = response;\n  });\n  console.log(globalInfo);\n}\n\n//get form data function\nfunction getFormData() {\n  debugger;\n  console.log('getting form data');\n  APILogBuffer('getting form data');\n\n  //make request to API to recieve push notification\n  window.JF.getFormSubmissions(globalInfo().formID, function (response) {\n    console.log('get form data ' + response);\n    debugger;\n    console.log('recieved form submission data');\n    APILogBuffer('recieved form submission data');\n\n    //if there are form submissions, store the submissions in the applicable variables\n    if (response.length >= 1) {\n      console.log('get form data globalinfo ' + globalInfo());\n      console.log('submission responses' + globalInfo().submissionResponses);\n      globalInfo().submissionResponses = response;\n      //reverse submissionResponse so the latest push is always at the end of the array\n      globalInfo().submissionResponses.reverse();\n      console.log('submission responses after reverse' + globalInfo().submissionResponses);\n    } else {\n      console.log('no responses recieved yet');\n      APILogBuffer('no responses recieved yet');\n    }\n  });\n}\n\n//TODO: was upto line 67\n\n//trigger the setInterval to check for form push data\nvar checkForFormPushData = '';\nfunction triggerFormPushDataSearch() {\n  console.log('get triggerformpushdata globalinfo ' + globalInfo());\n  debugger;\n  //check every second for a new post\n  checkForFormPushData = setInterval(() => {\n    debugger;\n    getFormData();\n    //if this is the first time push is being activated\n    if (globalInfo().submissionResponseArrayIndex === false && globalInfo().submissionResponses != '') {\n      var pushResponse = globalInfo().submissionResponses[0].answers[globalInfo().responseAnswerNumber];\n      console.log('the new submission is' + globalInfo().submissionResponses);\n      //end push response to insertPush function, which will handle push response to screen\n      insertPush(pushResponse.answer);\n      //store current response index, so eg submissionResponses[submissionResponseArrayIndex]\n      globalInfo().submissionResponseArrayIndex = 0;\n\n      //stop interval once push is up\n      stopFormApi();\n      globalInfo().lastSubmissionResponseLength = globalInfo().submissionResponses.length;\n    }\n    //else if this is not the first time the push has been activated\n    //check if the submissionResponseArray has had another push added since last time, via submissionResponseArrayIndex\n    //if so, send next push\n    else if (globalInfo().submissionResponseArrayIndex >= 0 && /* submissionResponseArrayIndex <= submissionResponses.length &&*/globalInfo().submissionResponseArrayIndex < globalInfo().submissionResponses.length - 1 && globalInfo().submissionResponses != '') {\n      globalInfo().lastSubmissionResponseLength++;\n      globalInfo().submissionResponseArrayIndex++;\n      console.log('number of data in index is ' + globalInfo().submissionResponseArrayIndex + ' and data in actual array is' + globalInfo().submissionResponses.length);\n\n      //pushResponse becomes the answer for the latest submission\n      var pushResponse = globalInfo().submissionResponses[globalInfo().submissionResponseArrayIndex].answers[globalInfo().responseAnswerNumber];\n\n      //end push response to insertPush function, which will handle push response to screen\n      insertPush(pushResponse.answer);\n\n      //stop interval once push is up\n      stopFormApi();\n    }\n  }, globalInfo().dataRefreshTime);\n}\n\n//stop searching for push data function\nfunction stopFormApi() {\n  /* setTimeout( () => { */\n  console.log('API has stopped');\n  APILogBuffer('API has stopped');\n  clearInterval(checkForFormPushData);\n  /* },5000) */\n}\n\nexport { APILogBuffer, fetchSubmissionResponses, triggerFormPushDataSearch, checkForFormPushData };\n\n/****************************************************** \r\n I THINK BELOW CAN BE DELETED \r\n ******************************************************/\n\n// var jotformApiScript = document.querySelector('#jotform-api-script');\n// var jotformApiInit = document.querySelector('#jotform-api-init');\n\n// var body = document.querySelector('body')\n// var apiScriptSrc; //used to retrieve API URL prior to removing from DOM\n\n// //initialise the script\n// function initScript(API){\n//     API.initialize( {apiKey: \"f78958f78beefa5e3e88255e7559579b\"} ); \n//  }\n\n// //delete script tag with jotform API URL\n// function deletePreviousAPIScript(APIscript){\n//     apiScriptSrc = jotformApiScript.src\n//     body.removeChild(APIscript)\n// }\n\n// //reinject the jotform URL inside a new script tag\n// function reinjectAPIScript(APIScript){\n//     //debugger;\n//     APIScript = document.createElement('script'); //create new script\n//     APIScript.src = apiScriptSrc\n//     body.appendChild(APIScript) \n\n//     jotformApiScript = APIScript; //assign API script variable to be new script variable\n// }\n\n//TODO: FInalise below code in log usage info button \n\n// deletePreviousAPIScript(jotformApiScript);\n\n// reinjectAPIScript(jotformApiScript);\n\n//initScript(JF)\n\n// JF.getUsage((response) => console.log(response));\nvar _c;\n$RefreshReg$(_c, \"APILogBuffer\");","map":{"version":3,"names":["globalInfo","insertPush","APILogBuffer","log","setTimeout","console","APIStatus","innerHTML","fetchSubmissionResponses","window","JF","getFormSubmissions","formID","response","submissionResponses","getFormData","length","reverse","checkForFormPushData","triggerFormPushDataSearch","setInterval","submissionResponseArrayIndex","pushResponse","answers","responseAnswerNumber","answer","stopFormApi","lastSubmissionResponseLength","dataRefreshTime","clearInterval"],"sources":["C:/Users/Josh/Documents/Code/push-ui-v1/my-app/src/designed_ui/global_functions.js"],"sourcesContent":["import {globalInfo} from './global_Info.js';\r\nimport{insertPush} from './pushExample/functions';\r\n\r\n//takes a string and injects it into the API status after 2 seconds\r\nfunction APILogBuffer(log){\r\n    debugger;\r\n    //after 10s, return the string (log)\r\n    setTimeout( () => {\r\n        console.log(globalInfo());\r\n        globalInfo().APIStatus.innerHTML =  log;\r\n    },2000)\r\n}\r\n\r\n//fetch all submission data into an array from the API\r\nfunction fetchSubmissionResponses(){\r\n    debugger;\r\n    console.log(globalInfo());\r\n    window.JF.getFormSubmissions(globalInfo().formID, function(response){\r\n        console.log('recieved form submission data')    \r\n        console.log('delete function responses ' + response);\r\n        //add all responses to globalInfo so accesible globally\r\n        globalInfo().submissionResponses = response;\r\n    })\r\n    console.log(globalInfo);\r\n}\r\n\r\n//get form data function\r\nfunction getFormData() {\r\n    debugger;\r\n    console.log('getting form data')\r\n    APILogBuffer('getting form data')\r\n    \r\n    //make request to API to recieve push notification\r\n    window.JF.getFormSubmissions(globalInfo().formID, function(response){\r\n\r\n        console.log('get form data ' + response);\r\n\r\n        debugger;\r\n        console.log('recieved form submission data')\r\n        APILogBuffer('recieved form submission data')\r\n        \r\n        //if there are form submissions, store the submissions in the applicable variables\r\n        if(response.length >= 1){\r\n            console.log('get form data globalinfo ' + globalInfo());\r\n            console.log('submission responses' + globalInfo().submissionResponses);\r\n\r\n            globalInfo().submissionResponses = response;\r\n            //reverse submissionResponse so the latest push is always at the end of the array\r\n            globalInfo().submissionResponses.reverse();  \r\n\r\n            console.log('submission responses after reverse' + globalInfo().submissionResponses);\r\n        }else{\r\n            console.log('no responses recieved yet')\r\n            APILogBuffer('no responses recieved yet')\r\n        }\r\n\r\n    })\r\n}\r\n\r\n//TODO: was upto line 67\r\n\r\n//trigger the setInterval to check for form push data\r\nvar checkForFormPushData = '';\r\nfunction triggerFormPushDataSearch(){\r\n    console.log('get triggerformpushdata globalinfo ' + globalInfo());\r\n    debugger;\r\n    //check every second for a new post\r\n    checkForFormPushData = setInterval( () => {\r\n        debugger;\r\n        getFormData();\r\n        //if this is the first time push is being activated\r\n        if(globalInfo().submissionResponseArrayIndex === false && globalInfo().submissionResponses != ''){\r\n            var pushResponse = globalInfo().submissionResponses[0].answers[globalInfo().responseAnswerNumber];\r\n            console.log('the new submission is' + globalInfo().submissionResponses)\r\n            //end push response to insertPush function, which will handle push response to screen\r\n            insertPush(pushResponse.answer)\r\n            //store current response index, so eg submissionResponses[submissionResponseArrayIndex]\r\n            globalInfo().submissionResponseArrayIndex = 0;\r\n  \r\n            //stop interval once push is up\r\n            stopFormApi()\r\n            \r\n            globalInfo().lastSubmissionResponseLength = globalInfo().submissionResponses.length;\r\n        }\r\n        //else if this is not the first time the push has been activated\r\n        //check if the submissionResponseArray has had another push added since last time, via submissionResponseArrayIndex\r\n        //if so, send next push\r\n        else if (globalInfo().submissionResponseArrayIndex >= 0 && /* submissionResponseArrayIndex <= submissionResponses.length &&*/ globalInfo().submissionResponseArrayIndex < globalInfo().submissionResponses.length-1 && globalInfo().submissionResponses != ''){\r\n            globalInfo().lastSubmissionResponseLength++;\r\n            globalInfo().submissionResponseArrayIndex++;\r\n            console.log('number of data in index is ' + globalInfo().submissionResponseArrayIndex + ' and data in actual array is' + globalInfo().submissionResponses.length)\r\n            \r\n            //pushResponse becomes the answer for the latest submission\r\n            var pushResponse = globalInfo().submissionResponses[globalInfo().submissionResponseArrayIndex].answers[globalInfo().responseAnswerNumber];\r\n\r\n                //end push response to insertPush function, which will handle push response to screen\r\n            insertPush(pushResponse.answer);\r\n\r\n            //stop interval once push is up\r\n            stopFormApi()\r\n        }\r\n\r\n    },globalInfo().dataRefreshTime)\r\n}\r\n\r\n//stop searching for push data function\r\nfunction stopFormApi(){\r\n\r\n    /* setTimeout( () => { */\r\n            console.log('API has stopped');\r\n            APILogBuffer('API has stopped');\r\n            clearInterval(checkForFormPushData);\r\n    /* },5000) */\r\n\r\n    }\r\n\r\n\r\n\r\n\r\nexport {APILogBuffer,fetchSubmissionResponses,triggerFormPushDataSearch,checkForFormPushData}\r\n\r\n\r\n\r\n/****************************************************** \r\n I THINK BELOW CAN BE DELETED \r\n ******************************************************/\r\n\r\n\r\n\r\n// var jotformApiScript = document.querySelector('#jotform-api-script');\r\n// var jotformApiInit = document.querySelector('#jotform-api-init');\r\n\r\n\r\n// var body = document.querySelector('body')\r\n// var apiScriptSrc; //used to retrieve API URL prior to removing from DOM\r\n\r\n\r\n// //initialise the script\r\n// function initScript(API){\r\n//     API.initialize( {apiKey: \"f78958f78beefa5e3e88255e7559579b\"} ); \r\n//  }\r\n\r\n\r\n\r\n\r\n\r\n// //delete script tag with jotform API URL\r\n// function deletePreviousAPIScript(APIscript){\r\n//     apiScriptSrc = jotformApiScript.src\r\n//     body.removeChild(APIscript)\r\n// }\r\n\r\n// //reinject the jotform URL inside a new script tag\r\n// function reinjectAPIScript(APIScript){\r\n//     //debugger;\r\n//     APIScript = document.createElement('script'); //create new script\r\n//     APIScript.src = apiScriptSrc\r\n//     body.appendChild(APIScript) \r\n\r\n//     jotformApiScript = APIScript; //assign API script variable to be new script variable\r\n// }\r\n\r\n\r\n\r\n //TODO: FInalise below code in log usage info button \r\n\r\n// deletePreviousAPIScript(jotformApiScript);\r\n\r\n// reinjectAPIScript(jotformApiScript);\r\n \r\n //initScript(JF)\r\n\r\n// JF.getUsage((response) => console.log(response));"],"mappings":"AAAA,SAAQA,UAAU,QAAO,kBAAkB;AAC3C,SAAOC,UAAU,QAAO,yBAAyB;;AAEjD;AACA,SAASC,YAAY,CAACC,GAAG,EAAC;EACtB;EACA;EACAC,UAAU,CAAE,MAAM;IACdC,OAAO,CAACF,GAAG,CAACH,UAAU,EAAE,CAAC;IACzBA,UAAU,EAAE,CAACM,SAAS,CAACC,SAAS,GAAIJ,GAAG;EAC3C,CAAC,EAAC,IAAI,CAAC;AACX;;AAEA;AAAA,KATSD,YAAY;AAUrB,SAASM,wBAAwB,GAAE;EAC/B;EACAH,OAAO,CAACF,GAAG,CAACH,UAAU,EAAE,CAAC;EACzBS,MAAM,CAACC,EAAE,CAACC,kBAAkB,CAACX,UAAU,EAAE,CAACY,MAAM,EAAE,UAASC,QAAQ,EAAC;IAChER,OAAO,CAACF,GAAG,CAAC,+BAA+B,CAAC;IAC5CE,OAAO,CAACF,GAAG,CAAC,4BAA4B,GAAGU,QAAQ,CAAC;IACpD;IACAb,UAAU,EAAE,CAACc,mBAAmB,GAAGD,QAAQ;EAC/C,CAAC,CAAC;EACFR,OAAO,CAACF,GAAG,CAACH,UAAU,CAAC;AAC3B;;AAEA;AACA,SAASe,WAAW,GAAG;EACnB;EACAV,OAAO,CAACF,GAAG,CAAC,mBAAmB,CAAC;EAChCD,YAAY,CAAC,mBAAmB,CAAC;;EAEjC;EACAO,MAAM,CAACC,EAAE,CAACC,kBAAkB,CAACX,UAAU,EAAE,CAACY,MAAM,EAAE,UAASC,QAAQ,EAAC;IAEhER,OAAO,CAACF,GAAG,CAAC,gBAAgB,GAAGU,QAAQ,CAAC;IAExC;IACAR,OAAO,CAACF,GAAG,CAAC,+BAA+B,CAAC;IAC5CD,YAAY,CAAC,+BAA+B,CAAC;;IAE7C;IACA,IAAGW,QAAQ,CAACG,MAAM,IAAI,CAAC,EAAC;MACpBX,OAAO,CAACF,GAAG,CAAC,2BAA2B,GAAGH,UAAU,EAAE,CAAC;MACvDK,OAAO,CAACF,GAAG,CAAC,sBAAsB,GAAGH,UAAU,EAAE,CAACc,mBAAmB,CAAC;MAEtEd,UAAU,EAAE,CAACc,mBAAmB,GAAGD,QAAQ;MAC3C;MACAb,UAAU,EAAE,CAACc,mBAAmB,CAACG,OAAO,EAAE;MAE1CZ,OAAO,CAACF,GAAG,CAAC,oCAAoC,GAAGH,UAAU,EAAE,CAACc,mBAAmB,CAAC;IACxF,CAAC,MAAI;MACDT,OAAO,CAACF,GAAG,CAAC,2BAA2B,CAAC;MACxCD,YAAY,CAAC,2BAA2B,CAAC;IAC7C;EAEJ,CAAC,CAAC;AACN;;AAEA;;AAEA;AACA,IAAIgB,oBAAoB,GAAG,EAAE;AAC7B,SAASC,yBAAyB,GAAE;EAChCd,OAAO,CAACF,GAAG,CAAC,qCAAqC,GAAGH,UAAU,EAAE,CAAC;EACjE;EACA;EACAkB,oBAAoB,GAAGE,WAAW,CAAE,MAAM;IACtC;IACAL,WAAW,EAAE;IACb;IACA,IAAGf,UAAU,EAAE,CAACqB,4BAA4B,KAAK,KAAK,IAAIrB,UAAU,EAAE,CAACc,mBAAmB,IAAI,EAAE,EAAC;MAC7F,IAAIQ,YAAY,GAAGtB,UAAU,EAAE,CAACc,mBAAmB,CAAC,CAAC,CAAC,CAACS,OAAO,CAACvB,UAAU,EAAE,CAACwB,oBAAoB,CAAC;MACjGnB,OAAO,CAACF,GAAG,CAAC,uBAAuB,GAAGH,UAAU,EAAE,CAACc,mBAAmB,CAAC;MACvE;MACAb,UAAU,CAACqB,YAAY,CAACG,MAAM,CAAC;MAC/B;MACAzB,UAAU,EAAE,CAACqB,4BAA4B,GAAG,CAAC;;MAE7C;MACAK,WAAW,EAAE;MAEb1B,UAAU,EAAE,CAAC2B,4BAA4B,GAAG3B,UAAU,EAAE,CAACc,mBAAmB,CAACE,MAAM;IACvF;IACA;IACA;IACA;IAAA,KACK,IAAIhB,UAAU,EAAE,CAACqB,4BAA4B,IAAI,CAAC,IAAI,kEAAmErB,UAAU,EAAE,CAACqB,4BAA4B,GAAGrB,UAAU,EAAE,CAACc,mBAAmB,CAACE,MAAM,GAAC,CAAC,IAAIhB,UAAU,EAAE,CAACc,mBAAmB,IAAI,EAAE,EAAC;MAC1Pd,UAAU,EAAE,CAAC2B,4BAA4B,EAAE;MAC3C3B,UAAU,EAAE,CAACqB,4BAA4B,EAAE;MAC3ChB,OAAO,CAACF,GAAG,CAAC,6BAA6B,GAAGH,UAAU,EAAE,CAACqB,4BAA4B,GAAG,8BAA8B,GAAGrB,UAAU,EAAE,CAACc,mBAAmB,CAACE,MAAM,CAAC;;MAEjK;MACA,IAAIM,YAAY,GAAGtB,UAAU,EAAE,CAACc,mBAAmB,CAACd,UAAU,EAAE,CAACqB,4BAA4B,CAAC,CAACE,OAAO,CAACvB,UAAU,EAAE,CAACwB,oBAAoB,CAAC;;MAErI;MACJvB,UAAU,CAACqB,YAAY,CAACG,MAAM,CAAC;;MAE/B;MACAC,WAAW,EAAE;IACjB;EAEJ,CAAC,EAAC1B,UAAU,EAAE,CAAC4B,eAAe,CAAC;AACnC;;AAEA;AACA,SAASF,WAAW,GAAE;EAElB;EACQrB,OAAO,CAACF,GAAG,CAAC,iBAAiB,CAAC;EAC9BD,YAAY,CAAC,iBAAiB,CAAC;EAC/B2B,aAAa,CAACX,oBAAoB,CAAC;EAC3C;AAEA;;AAKJ,SAAQhB,YAAY,EAACM,wBAAwB,EAACW,yBAAyB,EAACD,oBAAoB;;AAI5F;AACA;AACA;;AAIA;AACA;;AAGA;AACA;;AAGA;AACA;AACA;AACA;;AAMA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAIC;;AAED;;AAEA;;AAEC;;AAED;AAAA;AAAA"},"metadata":{},"sourceType":"module"}