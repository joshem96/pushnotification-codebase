{"ast":null,"code":"import { globalInfo } from './global_Info.js';\nimport { insertPush, popupElementsObject } from './pushExample/functions';\n\n//takes a string and injects it into the API status after 2 seconds\nfunction APILogBuffer(log) {\n  //after 10s, return the string (log)\n  setTimeout(() => globalInfo.APIStatus.innerHTML = log, 2000);\n}\n\n//fetch all submission data into an array from the API\n_c = APILogBuffer;\nfunction fetchSubmissionResponses() {\n  window.JF.getFormSubmissions(globalInfo.formID, function (response) {\n    //add all responses to globalInfo so accesible globally\n    globalInfo.submissionResponses = response;\n  });\n}\n\n//get form data function and store into globeInfo\nfunction getFormData() {\n  APILogBuffer('getting form data');\n\n  //make request to API to recieve push notification\n  window.JF.getFormSubmissions(globalInfo.formID, function (response) {\n    console.log(' date of recieved fetch ' + new Date());\n    APILogBuffer('recieved form submission data');\n    console.log(globalInfo);\n\n    //if delete submissions script has been ran\n    //which means the stored submissionsResponses length will be greater than the API response\n    //reset all necessary values, as if the script hasn't been ran yet\n    //response.length === 1 && globalInfo.submissionResponses.length > 1\n    if (globalInfo.submissionResponses.length > 1 && response.length < globalInfo.submissionResponses.length) {\n      // assign reponse to globalInfo appriate value\n      globalInfo.submissionResponses = response;\n      //reverse submissionResponse so the latest push is always at the end of the array\n      globalInfo.submissionResponses.reverse();\n      //reset the arrayIndex, so it starts pulling from the start of the new responses\n      globalInfo.submissionResponseArrayIndex = false;\n      console.log('array index has been reset');\n    }\n    //if there are form submissions, store the submissions in global info as appropriate values\n    else if (response.length >= 1) {\n      // assign reponse to globalInfo appriate value\n      globalInfo.submissionResponses = response;\n      //reverse submissionResponse so the latest push is always at the end of the array\n      globalInfo.submissionResponses.reverse();\n    }\n    //if no form submisions yet, update status log with relevant info & enable \"stop searching btn\"\n    else {\n      APILogBuffer('no responses recieved yet');\n      console.log(globalInfo);\n      globalInfo.buttonStop.classList.remove('disabled-btn');\n    }\n  });\n}\n\n//trigger the setInterval to check for form push data\nvar checkForFormPushData = '';\nfunction triggerFormPushDataSearch() {\n  //check every second for a new post\n  checkForFormPushData = setInterval(() => {\n    //get form data responses\n    getFormData();\n    console.log('date of init fetch' + new Date());\n    //if this is the first time push is being activated\n    if (globalInfo.submissionResponseArrayIndex === false && globalInfo.submissionResponses != '') {\n      //assign push response to variable\n      var pushResponse = globalInfo.submissionResponses[0].answers[globalInfo.responseAnswerNumber];\n\n      //insert newly recieved push response into push and display push (visa insertPush())\n      insertPush(pushResponse.answer);\n\n      //store current response index, so eg submissionResponses[submissionResponseArrayIndex]\n      globalInfo.submissionResponseArrayIndex = 0;\n\n      //stop interval once push is up\n      stopFormApi();\n      globalInfo.lastSubmissionResponseLength = globalInfo.submissionResponses.length;\n    }\n    //else if this is not the first time the push has been activated\n    //check if the submissionResponseArray has had another push added since last time, via submissionResponseArrayIndex\n    //if so, send next push\n    else if (globalInfo.submissionResponseArrayIndex >= 0 && globalInfo.submissionResponseArrayIndex < globalInfo.submissionResponses.length - 1 && globalInfo.submissionResponses != '') {\n      globalInfo.lastSubmissionResponseLength++;\n      globalInfo.submissionResponseArrayIndex++;\n\n      //pushResponse becomes the answer for the latest submission\n      var pushResponse = globalInfo.submissionResponses[globalInfo.submissionResponseArrayIndex].answers[globalInfo.responseAnswerNumber];\n\n      //end push response to insertPush function, which will handle push response to screen\n      insertPush(pushResponse.answer);\n\n      //stop interval once push is up\n      stopFormApi();\n    }\n    //else if this is last push in array and that push has already been shown, show stop button\n    else if (globalInfo.submissionResponseArrayIndex === globalInfo.submissionResponses.length - 1 && popupElementsObject.popUpContainer.style.visibility != 'visible') {\n      console.log(new Date() + ' last push statement ran');\n      globalInfo.buttonStop.classList.remove('disabled-btn');\n      //stopFormApi();\n    }\n  }, globalInfo.dataRefreshTime);\n}\n\n//stop searching for push data function\nfunction stopFormApi() {\n  APILogBuffer('API has stopped');\n  clearInterval(checkForFormPushData); // stop interval thats checking for form responses/data\n}\n\n//CHECK IF LAST PUSH IS THE LAST IN OF SUBMISSION RESPONSES\nfunction isCurrentPushLastPush() {\n  debugger;\n  console.log(globalInfo);\n  var result = globalInfo.submissionResponseArrayIndex === globalInfo.submissionResponses.length - 1 ? true : false;\n  return result;\n}\n//when user has no more notifcations remaining or none have been sent yet, show \"stop searching\" btn\n//is triggered on events like the \"exit button\" \nfunction handleExitOfLastPush() {\n  if (isCurrentPushLastPush()) {\n    debugger;\n    globalInfo.buttonStop.classList.remove('disabled-btn');\n  }\n}\nexport { APILogBuffer, fetchSubmissionResponses, triggerFormPushDataSearch, checkForFormPushData, handleExitOfLastPush, getFormData };\nvar _c;\n$RefreshReg$(_c, \"APILogBuffer\");","map":{"version":3,"names":["globalInfo","insertPush","popupElementsObject","APILogBuffer","log","setTimeout","APIStatus","innerHTML","fetchSubmissionResponses","window","JF","getFormSubmissions","formID","response","submissionResponses","getFormData","console","Date","length","reverse","submissionResponseArrayIndex","buttonStop","classList","remove","checkForFormPushData","triggerFormPushDataSearch","setInterval","pushResponse","answers","responseAnswerNumber","answer","stopFormApi","lastSubmissionResponseLength","popUpContainer","style","visibility","dataRefreshTime","clearInterval","isCurrentPushLastPush","result","handleExitOfLastPush"],"sources":["C:/Users/Josh/Documents/Code/push-ui-v1/my-app/src/designed_ui/global_functions.js"],"sourcesContent":["import {globalInfo} from './global_Info.js';\r\nimport{insertPush,popupElementsObject} from './pushExample/functions';\r\n\r\n\r\n//takes a string and injects it into the API status after 2 seconds\r\nfunction APILogBuffer(log){\r\n    //after 10s, return the string (log)\r\n    setTimeout( () => globalInfo.APIStatus.innerHTML =  log,2000);\r\n}\r\n\r\n\r\n//fetch all submission data into an array from the API\r\nfunction fetchSubmissionResponses(){\r\n    window.JF.getFormSubmissions(globalInfo.formID, function(response){\r\n        //add all responses to globalInfo so accesible globally\r\n        globalInfo.submissionResponses = response;\r\n    });\r\n}\r\n\r\n\r\n//get form data function and store into globeInfo\r\nfunction getFormData() {\r\n\r\n    APILogBuffer('getting form data');\r\n    \r\n    //make request to API to recieve push notification\r\n    window.JF.getFormSubmissions(globalInfo.formID, function(response){\r\n        console.log(' date of recieved fetch ' + new Date);\r\n        APILogBuffer('recieved form submission data');\r\n        console.log(globalInfo)\r\n        \r\n        //if delete submissions script has been ran\r\n        //which means the stored submissionsResponses length will be greater than the API response\r\n        //reset all necessary values, as if the script hasn't been ran yet\r\n        //response.length === 1 && globalInfo.submissionResponses.length > 1\r\n        if(globalInfo.submissionResponses.length > 1 && response.length < globalInfo.submissionResponses.length ){\r\n            // assign reponse to globalInfo appriate value\r\n            globalInfo.submissionResponses = response; \r\n            //reverse submissionResponse so the latest push is always at the end of the array\r\n            globalInfo.submissionResponses.reverse();  \r\n            //reset the arrayIndex, so it starts pulling from the start of the new responses\r\n            globalInfo.submissionResponseArrayIndex = false;\r\n\r\n            console.log('array index has been reset')\r\n        }\r\n        //if there are form submissions, store the submissions in global info as appropriate values\r\n        else if(response.length >= 1){\r\n            // assign reponse to globalInfo appriate value\r\n            globalInfo.submissionResponses = response; \r\n            //reverse submissionResponse so the latest push is always at the end of the array\r\n            globalInfo.submissionResponses.reverse();  \r\n        }\r\n        //if no form submisions yet, update status log with relevant info & enable \"stop searching btn\"\r\n        else{\r\n            APILogBuffer('no responses recieved yet');\r\n            console.log(globalInfo);\r\n            globalInfo.buttonStop.classList.remove('disabled-btn');\r\n        }\r\n\r\n    });\r\n}\r\n\r\n\r\n//trigger the setInterval to check for form push data\r\nvar checkForFormPushData = '';\r\nfunction triggerFormPushDataSearch(){\r\n\r\n    //check every second for a new post\r\n    checkForFormPushData = setInterval( () => {\r\n\r\n        //get form data responses\r\n        getFormData();\r\n        console.log('date of init fetch' + new Date)\r\n        //if this is the first time push is being activated\r\n        if(globalInfo.submissionResponseArrayIndex === false && globalInfo.submissionResponses != ''){\r\n            //assign push response to variable\r\n            var pushResponse = globalInfo.submissionResponses[0].answers[globalInfo.responseAnswerNumber];\r\n\r\n            //insert newly recieved push response into push and display push (visa insertPush())\r\n            insertPush(pushResponse.answer);\r\n\r\n            //store current response index, so eg submissionResponses[submissionResponseArrayIndex]\r\n            globalInfo.submissionResponseArrayIndex = 0;\r\n  \r\n            //stop interval once push is up\r\n            stopFormApi();\r\n            \r\n            globalInfo.lastSubmissionResponseLength = globalInfo.submissionResponses.length;\r\n        }\r\n        //else if this is not the first time the push has been activated\r\n        //check if the submissionResponseArray has had another push added since last time, via submissionResponseArrayIndex\r\n        //if so, send next push\r\n        else if (globalInfo.submissionResponseArrayIndex >= 0 && globalInfo.submissionResponseArrayIndex < globalInfo.submissionResponses.length-1 && globalInfo.submissionResponses != ''){\r\n            globalInfo.lastSubmissionResponseLength++;\r\n            globalInfo.submissionResponseArrayIndex++;\r\n            \r\n            //pushResponse becomes the answer for the latest submission\r\n            var pushResponse = globalInfo.submissionResponses[globalInfo.submissionResponseArrayIndex].answers[globalInfo.responseAnswerNumber];\r\n\r\n            //end push response to insertPush function, which will handle push response to screen\r\n            insertPush(pushResponse.answer);\r\n\r\n            //stop interval once push is up\r\n            stopFormApi();\r\n        }\r\n        //else if this is last push in array and that push has already been shown, show stop button\r\n        else if (globalInfo.submissionResponseArrayIndex === globalInfo.submissionResponses.length-1\r\n            && popupElementsObject.popUpContainer.style.visibility != 'visible'){\r\n            console.log(new Date + ' last push statement ran');\r\n            globalInfo.buttonStop.classList.remove('disabled-btn');\r\n            //stopFormApi();\r\n        }\r\n        \r\n\r\n    },globalInfo.dataRefreshTime)\r\n}\r\n\r\n\r\n//stop searching for push data function\r\nfunction stopFormApi(){\r\n    APILogBuffer('API has stopped');\r\n    clearInterval(checkForFormPushData); // stop interval thats checking for form responses/data\r\n}\r\n\r\n//CHECK IF LAST PUSH IS THE LAST IN OF SUBMISSION RESPONSES\r\nfunction isCurrentPushLastPush(){\r\n    debugger;\r\n    console.log(globalInfo);\r\n    var result = (globalInfo.submissionResponseArrayIndex === globalInfo.submissionResponses.length-1) ? true : false;\r\n    return result;\r\n}\r\n//when user has no more notifcations remaining or none have been sent yet, show \"stop searching\" btn\r\n//is triggered on events like the \"exit button\" \r\nfunction handleExitOfLastPush(){\r\n    if(isCurrentPushLastPush()){\r\n        debugger;\r\n        globalInfo.buttonStop.classList.remove('disabled-btn');\r\n    }\r\n}\r\n\r\n\r\n\r\nexport {APILogBuffer,fetchSubmissionResponses,triggerFormPushDataSearch,checkForFormPushData,handleExitOfLastPush,getFormData}\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}